#### 内存布局

今天一开始，我就又把我昨天草草设计的程序内存布局给推翻了。

因为这次要增加一个堆的部分，所以我昨天的设计不能用了，我也因此顺便重新设计了一个更正规的内存结构。

首先，数据段中最下层的是栈。我提前给栈设定了0x10000的空间。

然后，就是文件中的各种.rdata,.bss了，我利用PE中的NumofSections直接找到最后一个段，最后一个段好像是PE的栈帧段，对我而言没什么用，所以我就在栈帧段起始地址向上取整0x1000的地址作为我的malloc起始地址，向上就是堆了，一直延申到1M处。

顺便一提，我给每个程序都分配1M的内存，虽然有点奢侈。而且我给程序链接的基地址设置为了0x10000这是考量了栈的空间，并且因为没有虚拟内存的缘故，我只能将数据段的基地址设置为0x10000，这对程序而言挺方便的，就是有点费内存。

在搞定这个后，剩下的api就没什么难度了。

为了方便，我增加了个识别.exe的部分进console.c，免去了改名成hrb的麻烦。